<!DOCTYPE html>
<html lang="en">

<head>
  <title>CashTokens Webwallet</title>
  <link rel="icon" type="image/png" href="/images/favicon.png">
  <meta name="description" content="Bitcoin Cash Webwallet with CashTokens support for chipnet.">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://unpkg.com/chota@0.8.0/dist/chota.min.css">
  <link rel="stylesheet" href="style.css">
  <script defer src="https://cdn.mainnet.cash/mainnet-1.0.12.js"></script>
  <script>window.exports = {}</script>
  <script defer src="https://unpkg.com/@download/blockies@1.0.3/dist/blockies.min.js"></script>
</head>

<body>
  <div>
    <header>
      <h1>
        <img class="icon" style="width: 40px;" src="/images/favicon.png">
        CashTokens Webwallet
      </h1>
      <b>Connected to chipnet</b>
      <div>
        <nav class="nav hide">
          <div class="nav-left">
            <div class="tabs">
              <a id="view0" class="view active" onclick="changeView(0)">BchWallet</a>
              <a id="view1" class="view" onclick="changeView(1)">MyTokens</a>
              <a id="view2" class="view" onclick="changeView(2)">CreateTokens</a>
              <a id="view3" class="view" onclick="changeView(3)">
                <div><img class="icon settingsIcon" src="https://icongr.am/clarity/cog.svg?size=16"></div>
              </a>
            </div>
          </div>
        </nav>
      </div>
    </header>
  </div>
  <main>
    <div class="container">
      <div id="newWalletView" class="hide">
        <fieldset style="margin-top: 15px;">
            <h4><img class="icon plusIcon" src="https://icongr.am/feather/plus-square.svg?size=24"> Create new wallet</h4>
            <input class="button primary" type="button" value="Create" onclick="createNewWallet()">
            <br><br>
            <hr>
            <br>
            <h4><img class="icon importIcon" src="https://icongr.am/feather/log-in.svg?size=24"> Import existing wallet</h4> 
            <div>Enter mnemonic seed phrase</div>
            <div>Derivation path used is m/44'/0'/0'/0/0</div>
            <textarea style="resize: none;" id="enterSeedphrase"rows="3" cols="50" placeholder="word1 word2 ..."></textarea>
            <input class="button primary" type="button" style="margin-top:15px" value="Import" onclick="importWallet()">
            <br><br>
        </fieldset>
      </div>

      <div id="walletView" class="hide">

        <fieldset style="margin-top: 15px;">
          <div style="margin-top: 15px;">Wallet balance: <span id="balance" class="text-primary"></span></div>
          <div>Wallet token balance: <span id="tokenBalance" class="text-primary"></span></div>
          <div>Address: <span class="depositAddr" id="depositAddr"></span>
            <button type="button" style="background: none; padding: 0;" onclick="copyTextContent('depositAddr')">
              <img class="copyIcon" src="https://icongr.am/clarity/copy.svg?size=16&color=currentColor">
            </button>
          </div>
          <div class="is-center">Deposit QR</div>
          <div><img id="depositQr" class="depositQr" src="./images/qrcode.jpg" /></div>
          </p>
        </fieldset>
        <fieldset style="margin-top: 15px">
          <legend>Send tBCH to</legend>
          <p class="grouped">
            <input id="sendAddr" placeholder="address">
            <input id="sendAmount" placeholder="amount satoshis">
            <span class="maxButton" onclick="maxBch(event)">max</span>
          </p>

          <input type="button" id="send" value="Send">
        </fieldset>
      </div>

      <div id="tokenView" class="hide">
        <div id="noTokensFound"></div>
        <template id="token-template">
          <div class="item">
            <fieldset>
              <legend>
                <div id="tokenType"></div>
              </legend>
              <div class="tokenInfo">
                <div id="tokenIcon" class="tokenIcon"></div>
                <div>
                  <div id="tokenName"></div>
                  <div>
                    TokenId: <span id="tokenID" class="tokenID"></span>
                    <button type="button" style="background: none; padding: 0; " onclick="copyTokenID(event)">
                      <img class="copyIcon" src="https://icongr.am/clarity/copy.svg?size=16&color=currentColor">
                    </button>
                  </div>
                </div>
              </div>
              <div id="tokenCommitment"></div>
              <div id="tokenAmount"></div>
              <br>
              <div id="tokenSend" style="display: none;">
                Send these tokens to
                <p class="grouped">
                  <input id="tokenAddress" placeholder="token address">
                  <input id="sendTokenAmount" placeholder="amount tokens">
                  <span id="maxButton" class="maxButton">max</span>
                </p>
                <input type="button" id="sendSomeButton" value="Send">
              </div>
              <div id="nftSend" style="display: none;">
                Send this NFT to
                <p class="grouped">
                  <input id="tokenAddress" placeholder="tokenAddress">
                  <input type="button" id="sendNFT" value="Send NFT">
                </p>
              </div>
              <div id="nftMint" style="display: none;">
                Mint immutable NFT
                <p class="grouped">
                  <input id="commitmentInput" placeholder="commitment">
                  <input type="button" id="mintNFT" value="Mint NFT">
                </p>
              </div>
            </fieldset>
          </div>
        </template>

        <div id="Placeholder"></div>
      </div>

      <div id="createTokensView" class="hide">
        <fieldset class="item">
          <legend>Create new tokens</legend>
          <label for="newtokens">Select token-type:</label>
          <select name="newtokens" id="newtokens" onchange="selectTokenType(event)">
            <option value="fungibles">Fungible Tokens</option>
            <option value="mintingNFT">Minting NFT</option>
            <option value="immutableNFT">Immutable NFT</option>
          </select>
          <br>
          <div style="margin-bottom: 1em;">
            Planned tokenId:
            <span id="plannedTokenId">loading...</span>
            <button type="button" style="background: none; padding: 0;" onclick="copyTokenID(event,'plannedTokenId')">
              <img class="copyIcon" src="https://icongr.am/clarity/copy.svg?size=16&color=currentColor">
            </button>
          </div>
          <div style="margin-bottom: 1em;">
            Choose the total supply of these fungible tokens
            <input id="tokenSupply" placeholder="total supply">
          </div>
          <div class="hide" style="margin-bottom: 1em;">
            Add immutable commitment data to add to this NFT (hexadecimals only)
            <input id="inputNftCommitment" placeholder="commitment">
          </div>
          <details>
            <summary>Optionally add a URL for the metadata registry of this token</summary>
            You can easily create this with Github Gist similar to 
              <a href="https://gist.github.com/mr-zwets/323c7786e2acf01e3c04a440d7cf6c2c" target="_blank">this example</a>. <br>
            Press "raw" button to get the url to the json object. <br>
            Copy this url without the 'https://'' prefix and everything after '/raw'. <br>
            This url together with the hash of its content will be stored on the blockchain.
            <input id="bcmrUrl" placeholder="gist.githubusercontent.com/mr-zwets/323c7786e2acf01e3c04a440d7cf6c2c/raw">
          </details>
          <br>
          Process might take a few seconds... 
          <input type="button" id="createTokens" value="Create">
        </fieldset>
      </div>

      <div id="settingsView" class="hide">
        <fieldset class="item">
          <legend>Settings</legend>
          <span style="margin-top: 15px;">Dark mode </span>
          <input type="checkbox" id="darkmode" style="margin: 0; vertical-align: text-bottom;" onclick="toggleDarkmode()">
        </fieldset>
      </div>

      <br>
      <footer class="footer hide" id="githubLink">
        <a href="https://github.com/mr-zwets/my-cashtokens-webwallet" target="_blank" >
            <img class="githublogo" src="./images/github.png" alt="Github logo">
        </a>
        <div style="margin-left: 10px;height: 60px;">
          <a href="https://github.com/mr-zwets/my-cashtokens-webwallet" target="_blank">
          <div>
            inspect source code
          </div>
          </a>
          <div>
            made with mainnet-js
          </div>
        </div>
        
      </footer>
    </div>
  </main>

  <script type="module" src="./script.js"></script>
</body>

</html>